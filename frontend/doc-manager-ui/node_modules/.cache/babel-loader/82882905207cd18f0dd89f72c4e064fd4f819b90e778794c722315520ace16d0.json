{"ast":null,"code":"// src/api.js\nimport config from\"./config\";const API_BASE_URL=`${config.API_BASE_URL}`;const apiFetch=async function(url){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const token=localStorage.getItem('authToken');const headers={...(options.responseType!=='blob'&&{'Content-Type':'application/json'}),...(token&&{'Authorization':`Bearer ${token}`})};try{const response=await fetch(`${url}`,{...options,headers});// handle 401 \nif(response.status===401){console.warn('401 Unauthorized - Redirecting to login');localStorage.removeItem('authToken');localStorage.removeItem('userRole');window.location.href='/login';return;}if(options.responseType==='blob'){return await response.blob();}// handle other errors\nif(!response.ok){const errorData=await response.json();throw new Error(errorData.message||'An error occurred');}// return response JSON\nreturn await response.json();}catch(error){console.error('API Error:',error.message);throw error;// Allow the caller to handle specific errors if needed\n}};export default apiFetch;","map":{"version":3,"names":["config","API_BASE_URL","apiFetch","url","options","arguments","length","undefined","token","localStorage","getItem","headers","responseType","response","fetch","status","console","warn","removeItem","window","location","href","blob","ok","errorData","json","Error","message","error"],"sources":["C:/Users/idilk/Documents/bitirme-main/ENS491-SUDoc/frontend/doc-manager-ui/src/api.js"],"sourcesContent":["// src/api.js\r\nimport config from \"./config\";\r\n\r\nconst API_BASE_URL = `${config.API_BASE_URL}`;\r\n\r\nconst apiFetch = async (url, options = {}) => {\r\n    const token = localStorage.getItem('authToken');\r\n\r\n    const headers = {\r\n        ...(options.responseType !== 'blob' && {'Content-Type': 'application/json'}),\r\n        ...(token && { 'Authorization': `Bearer ${token}` }) \r\n    };\r\n\r\n    try {\r\n        const response = await fetch(`${url}`, {\r\n            ...options,\r\n            headers\r\n        });\r\n\r\n        // handle 401 \r\n        if (response.status === 401) {\r\n            console.warn('401 Unauthorized - Redirecting to login');\r\n            localStorage.removeItem('authToken');\r\n            localStorage.removeItem('userRole');\r\n            window.location.href = '/login';\r\n            return;\r\n        }\r\n\r\n        if(options.responseType === 'blob') {\r\n            return await response.blob();\r\n        }\r\n\r\n        // handle other errors\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || 'An error occurred');\r\n        }\r\n\r\n        // return response JSON\r\n        return await response.json();\r\n\r\n    } catch (error) {\r\n        console.error('API Error:', error.message);\r\n        throw error; // Allow the caller to handle specific errors if needed\r\n    }\r\n};\r\n\r\nexport default apiFetch;\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,MAAM,KAAM,UAAU,CAE7B,KAAM,CAAAC,YAAY,CAAG,GAAGD,MAAM,CAACC,YAAY,EAAE,CAE7C,KAAM,CAAAC,QAAQ,CAAG,cAAAA,CAAOC,GAAG,CAAmB,IAAjB,CAAAC,OAAO,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CACrC,KAAM,CAAAG,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAE/C,KAAM,CAAAC,OAAO,CAAG,CACZ,IAAIP,OAAO,CAACQ,YAAY,GAAK,MAAM,EAAI,CAAC,cAAc,CAAE,kBAAkB,CAAC,CAAC,CAC5E,IAAIJ,KAAK,EAAI,CAAE,eAAe,CAAE,UAAUA,KAAK,EAAG,CAAC,CACvD,CAAC,CAED,GAAI,CACA,KAAM,CAAAK,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,GAAGX,GAAG,EAAE,CAAE,CACnC,GAAGC,OAAO,CACVO,OACJ,CAAC,CAAC,CAEF;AACA,GAAIE,QAAQ,CAACE,MAAM,GAAK,GAAG,CAAE,CACzBC,OAAO,CAACC,IAAI,CAAC,yCAAyC,CAAC,CACvDR,YAAY,CAACS,UAAU,CAAC,WAAW,CAAC,CACpCT,YAAY,CAACS,UAAU,CAAC,UAAU,CAAC,CACnCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,QAAQ,CAC/B,OACJ,CAEA,GAAGjB,OAAO,CAACQ,YAAY,GAAK,MAAM,CAAE,CAChC,MAAO,MAAM,CAAAC,QAAQ,CAACS,IAAI,CAAC,CAAC,CAChC,CAEA;AACA,GAAI,CAACT,QAAQ,CAACU,EAAE,CAAE,CACd,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAAX,QAAQ,CAACY,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAC,KAAK,CAACF,SAAS,CAACG,OAAO,EAAI,mBAAmB,CAAC,CAC7D,CAEA;AACA,MAAO,MAAM,CAAAd,QAAQ,CAACY,IAAI,CAAC,CAAC,CAEhC,CAAE,MAAOG,KAAK,CAAE,CACZZ,OAAO,CAACY,KAAK,CAAC,YAAY,CAAEA,KAAK,CAACD,OAAO,CAAC,CAC1C,KAAM,CAAAC,KAAK,CAAE;AACjB,CACJ,CAAC,CAED,cAAe,CAAA1B,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}