{"ast":null,"code":"import React,{useState}from'react';import'./sidepanelupload.css';// Import the CSS file for styling\nimport config from\"../../config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FileUpload=()=>{const[uploadStatus,setUploadStatus]=useState(null);// State to track upload success or error\nconst[isUploading,setIsUploading]=useState(false);const handleFileUpload=async event=>{const files=event.target.files;console.log(\"Files selected:\",files);if(files.length===0){setUploadStatus({success:false,message:'No files selected.'});return;}const allowedTypes=['application/pdf'];const invalidFiles=Array.from(files).filter(file=>!allowedTypes.includes(file.type));if(invalidFiles.length>0){setUploadStatus({success:false,message:'Please upload a valid PDF file.'});return;}try{setIsUploading(true);// Start uploading state\nconsole.log('Uploading started...');const formData=new FormData();for(let i=0;i<files.length;i++){formData.append('file',files[i]);}formData.append(\"replace_existing\",\"true\");const token=localStorage.getItem(\"authToken\");const response=await fetch(`${config.API_BASE_URL}/upload`,{method:'POST',body:formData,headers:{'Authorization':`Bearer ${token}`}});const result=await response.json();console.log('Upload result:',result);if(response.ok){if(result.warning){setUploadStatus({success:false,message:`Some files failed: ${result.failed_files.map(f=>f.filename).join(\", \")}`});}else{setUploadStatus({success:true,message:result.message});}}else if(response.status===403){setUploadStatus({success:false,message:'You need to be an admin to upload files'});}else{setUploadStatus({success:false,message:result.error||'Error uploading the file'});}}catch(error){console.error('Error uploading file:',error);setUploadStatus({success:false,message:'Failed to upload file'});}finally{setIsUploading(false);// End uploading state\n}};return/*#__PURE__*/_jsxs(\"div\",{className:\"file-upload-container\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"upload-button\",children:[isUploading?'Uploading...':'Choose PDF',/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,accept:\"application/pdf\",onChange:handleFileUpload,hidden:true})]}),uploadStatus&&/*#__PURE__*/_jsx(\"div\",{className:`upload-feedback ${uploadStatus.success?'success':'error'}`,children:uploadStatus.message})]});};export default FileUpload;","map":{"version":3,"names":["React","useState","config","jsx","_jsx","jsxs","_jsxs","FileUpload","uploadStatus","setUploadStatus","isUploading","setIsUploading","handleFileUpload","event","files","target","console","log","length","success","message","allowedTypes","invalidFiles","Array","from","filter","file","includes","type","formData","FormData","i","append","token","localStorage","getItem","response","fetch","API_BASE_URL","method","body","headers","result","json","ok","warning","failed_files","map","f","filename","join","status","error","className","children","multiple","accept","onChange","hidden"],"sources":["/Users/idil2/dolap-server-code/ENS492-RAGDocumentManager/frontend/doc-manager-ui/src/pages/side-panel-options/sidepanelupload.js"],"sourcesContent":["import React, { useState } from 'react';\nimport './sidepanelupload.css'; // Import the CSS file for styling\nimport config from \"../../config\";\n\nconst FileUpload = () => {\n  const [uploadStatus, setUploadStatus] = useState(null); // State to track upload success or error\n  const [isUploading, setIsUploading] = useState(false);\n\n  const handleFileUpload = async (event) => {\n    const files = event.target.files;\n    console.log(\"Files selected:\", files);\n\n    if(files.length === 0) {\n      setUploadStatus({success: false, message: 'No files selected.'});\n      return;\n    }\n\n    const allowedTypes = ['application/pdf'];\n    const invalidFiles = Array.from(files).filter(file => !allowedTypes.includes(file.type));\n\n    if(invalidFiles.length > 0) {\n      setUploadStatus({success: false, message: 'Please upload a valid PDF file.'});\n      return;\n    }\n\n    try {\n      setIsUploading(true); // Start uploading state\n      console.log('Uploading started...');\n\n      const formData = new FormData();\n      for(let i = 0; i < files.length; i++) {\n        formData.append('file', files[i]);\n      }\n\n      formData.append(\"replace_existing\", \"true\");\n\n      const token = localStorage.getItem(\"authToken\");\n      const response = await fetch(`${config.API_BASE_URL}/upload`, {\n        method: 'POST',\n        body: formData,\n        headers: {'Authorization': `Bearer ${token}`}\n      });\n\n      const result = await response.json();\n      console.log('Upload result:', result);\n\n      if (response.ok) {\n        if(result.warning) {\n          setUploadStatus({ success: false, message: `Some files failed: ${result.failed_files.map(f => f.filename).join(\", \")}`,});\n        }\n        else {\n          setUploadStatus({ success: true, message: result.message });\n        }\n      } else if(response.status === 403) {\n        setUploadStatus({ success: false, message: 'You need to be an admin to upload files'});\n      } else {\n        setUploadStatus({ success: false, message: result.error || 'Error uploading the file' });\n      }\n    } catch (error) {\n      console.error('Error uploading file:', error);\n      setUploadStatus({ success: false, message: 'Failed to upload file' });\n    } finally {\n      setIsUploading(false); // End uploading state\n    }\n  };\n\n  return (\n    <div className=\"file-upload-container\">\n\n      <label className=\"upload-button\">\n        {isUploading ? 'Uploading...' : 'Choose PDF'}\n        <input type=\"file\" multiple accept=\"application/pdf\"  onChange={handleFileUpload} hidden />\n      </label>\n\n      {/* Feedback message */}\n      {uploadStatus && (\n        <div\n          className={`upload-feedback ${uploadStatus.success ? 'success' : 'error'}`}\n        >\n          {uploadStatus.message}\n        </div>\n      )}\n    </div>\n  );\n};\n\n \nexport default FileUpload;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}