{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./documentManagement.css';import{Eye,RefreshCcw,RefreshCwIcon,Trash2}from'lucide-react';import config from\"../config\";import apiFetch from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DocumentManagement=()=>{const[searchTerm,setSearchTerm]=useState('');const[documents,setDocuments]=useState([]);const[isModalOpen,setIsModalOpen]=useState(false);const[documentToDelete,setDocumentToDelete]=useState(null);/* The `useEffect` hook in React is used to perform side effects in function components. In this case,\nthe `useEffect` hook is being used to fetch documents when the component mounts for the first time. */useEffect(()=>{fetchDocuments();},[]);const fetchDocuments=async()=>{try{const data=await apiFetch(`${config.API_BASE_URL}/get_documents`);setDocuments(data);}catch(error){console.error('Error fetching documents:',error);}};const viewDocument=async(e,docId)=>{const token=localStorage.getItem(\"authToken\");e.stopPropagation();try{const response=await fetch(`${config.API_BASE_URL}/get_pdf?file_id=${docId}`,{headers:{'Authorization':`Bearer ${token}`}});if(response.ok){const blob=await response.blob();const url=URL.createObjectURL(blob);window.open(url,'_blank');}else{console.error('Error fetching PDF:',await response.json());}}catch(error){console.error('Error fetching PDF:',error);}};const openDeleteModal=(e,docId)=>{e.stopPropagation();setDocumentToDelete(docId);setIsModalOpen(true);};const deleteDocument=async()=>{if(!documentToDelete)return;const token=localStorage.getItem(\"authToken\");try{const response=await fetch(`${config.API_BASE_URL}/delete_document?file_id=${documentToDelete}`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`}});const data=await response.json();if(response.ok){setDocuments(documents.filter(doc=>doc.id!==documentToDelete));console.log('Document deleted:',data.message);}else if(response.status===403){alert(\"You need to be an admin to delete a document!\");// placeholder admin degilsin alarmi\n}else{console.error('Error deleting document:',data.error);}}catch(error){console.error('Error deleting document:',error);}setIsModalOpen(false);setDocumentToDelete(null);};const handleSearch=e=>{setSearchTerm(e.target.value);};const filteredDocuments=documents.filter(doc=>doc.name.toLowerCase().includes(searchTerm.toLowerCase()));return/*#__PURE__*/_jsxs(\"div\",{className:\"document-management-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"documents-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search documents...\",value:searchTerm,onChange:handleSearch,className:\"search-input\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"view-button\",onClick:fetchDocuments,children:[/*#__PURE__*/_jsx(RefreshCcw,{size:16}),\" REFRESH\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"document-list\",children:filteredDocuments.length>0?filteredDocuments.map(doc=>/*#__PURE__*/_jsxs(\"div\",{className:\"document-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"document-name\",children:doc.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"document-buttons\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"view-button\",onClick:e=>viewDocument(e,doc.id),children:[/*#__PURE__*/_jsx(Eye,{size:16}),\" VIEW\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"delete-button\",onClick:e=>openDeleteModal(e,doc.id),children:[/*#__PURE__*/_jsx(Trash2,{size:16}),\" DELETE\"]})]})]},doc.id)):/*#__PURE__*/_jsx(\"div\",{children:\"No documents found\"})})]}),isModalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Confirm Deletion\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to delete this document?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"confirm-button\",onClick:deleteDocument,children:\"Yes, Delete\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-button\",onClick:()=>setIsModalOpen(false),children:\"Cancel\"})]})]})})]});};export default DocumentManagement;","map":{"version":3,"names":["React","useState","useEffect","Eye","RefreshCcw","RefreshCwIcon","Trash2","config","apiFetch","jsx","_jsx","jsxs","_jsxs","DocumentManagement","searchTerm","setSearchTerm","documents","setDocuments","isModalOpen","setIsModalOpen","documentToDelete","setDocumentToDelete","fetchDocuments","data","API_BASE_URL","error","console","viewDocument","e","docId","token","localStorage","getItem","stopPropagation","response","fetch","headers","ok","blob","url","URL","createObjectURL","window","open","json","openDeleteModal","deleteDocument","method","filter","doc","id","log","message","status","alert","handleSearch","target","value","filteredDocuments","name","toLowerCase","includes","className","children","type","placeholder","onChange","onClick","size","length","map"],"sources":["/Users/idil2/dolap-server-code/ENS492-RAGDocumentManager/frontend/doc-manager-ui/src/pages/documentManagement.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './documentManagement.css';\nimport { Eye, RefreshCcw, RefreshCwIcon, Trash2 } from 'lucide-react';\nimport config from \"../config\";\nimport apiFetch from '../api';\n\nconst DocumentManagement = () => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [documents, setDocuments] = useState([]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [documentToDelete, setDocumentToDelete] = useState(null);\n\n/* The `useEffect` hook in React is used to perform side effects in function components. In this case,\nthe `useEffect` hook is being used to fetch documents when the component mounts for the first time. */\n  useEffect(() => {\n    fetchDocuments();\n  }, []);\n\n  const fetchDocuments = async () => {\n    try {\n      const data = await apiFetch(`${config.API_BASE_URL}/get_documents`);\n      setDocuments(data);\n\n    } catch (error) {\n      console.error('Error fetching documents:', error);\n    }\n  };\n\n  const viewDocument = async (e, docId) => {\n    const token = localStorage.getItem(\"authToken\");\n    e.stopPropagation();\n    try {\n      const response = await fetch(`${config.API_BASE_URL}/get_pdf?file_id=${docId}`, {headers: {'Authorization': `Bearer ${token}`}});\n      if (response.ok) {\n        const blob = await response.blob();\n        const url = URL.createObjectURL(blob);\n        window.open(url, '_blank');\n      } else {\n        console.error('Error fetching PDF:', await response.json());\n      }\n    } catch (error) {\n      console.error('Error fetching PDF:', error);\n    }\n  };\n\n  const openDeleteModal = (e, docId) => {\n    e.stopPropagation();\n    setDocumentToDelete(docId);\n    setIsModalOpen(true);\n  };\n\n  const deleteDocument = async () => {\n    if (!documentToDelete) return;\n    const token = localStorage.getItem(\"authToken\");\n    try {\n      const response = await fetch(`${config.API_BASE_URL}/delete_document?file_id=${documentToDelete}`, {\n        method: 'POST', \n        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },\n      });\n\n      const data = await response.json();\n      if (response.ok) {\n        setDocuments(documents.filter(doc => doc.id !== documentToDelete));\n        console.log('Document deleted:', data.message);\n      } else if(response.status === 403) {\n        alert(\"You need to be an admin to delete a document!\"); // placeholder admin degilsin alarmi\n      } else {\n        console.error('Error deleting document:', data.error);\n      }\n    } catch (error) {\n      console.error('Error deleting document:', error);\n    }\n\n    setIsModalOpen(false);\n    setDocumentToDelete(null);\n  };\n\n  const handleSearch = (e) => {\n    setSearchTerm(e.target.value);\n  };\n\n  const filteredDocuments = documents.filter(doc =>\n    doc.name.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  return (\n    <div className=\"document-management-container\">\n      <div className=\"documents-container\">\n        <div className=\"input-container\">\n          <input\n            type=\"text\"\n            placeholder=\"Search documents...\"\n            value={searchTerm}\n            onChange={handleSearch}\n            className=\"search-input\"\n          />\n          <button className=\"view-button\" onClick={fetchDocuments}>\n            <RefreshCcw size={16} /> REFRESH\n          </button>\n        </div>\n\n        <div className=\"document-list\">\n          {filteredDocuments.length > 0 ? (\n            filteredDocuments.map(doc => (\n              <div key={doc.id} className=\"document-item\">\n                <span className=\"document-name\">{doc.name}</span>\n                <div className=\"document-buttons\">\n                  <button className=\"view-button\" onClick={(e) => viewDocument(e, doc.id)}>\n                    <Eye size={16} /> VIEW\n                  </button>\n                  <button className=\"delete-button\" onClick={(e) => openDeleteModal(e, doc.id)}>\n                    <Trash2 size={16} /> DELETE\n                  </button>\n                </div>\n              </div>\n            ))\n          ) : (\n            <div>No documents found</div>\n          )}\n        </div>\n      </div>\n\n      {isModalOpen && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal\">\n            <h3>Confirm Deletion</h3>\n            <p>Are you sure you want to delete this document?</p>\n            <div className=\"modal-buttons\">\n              <button className=\"confirm-button\" onClick={deleteDocument}>Yes, Delete</button>\n              <button className=\"cancel-button\" onClick={() => setIsModalOpen(false)}>Cancel</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default DocumentManagement;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}